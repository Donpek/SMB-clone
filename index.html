<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>SMB clone</title>

    <script src='jquery-3.2.1.min.js'></script>
    <script>
    /* GAME CONSTANTS */
    const TILE_W = TILE_H = 16;
    const FPS = 1000/30;
    const MAPS = [
      'maps/test.json',
    ];
    const TILE_IDS = {
      MARIO: 61,
      GOOMBA: 62,
      //KOOPA: 63,
      BRICK: 1,
      GROUND: 31,
      BOX_MYSTERY: 24,
      BOX_COIN: 14,
      BOX_RED_SHROOM: 4,
      PIPE_TOP: 9,
      RED_SHROOM: 51,
    };
    const SPRITES = [
      'sprites/main_sheet.png',
      'sprites/mario_sheet.png',
      'sprites/goomba_sheet.png',
    ];
    const GRAVITY = 5; // px/frame
    </script>

    <script src='misc.js'></script>
    <script src='canvas.js'></script>
    <script src='keyboard.js'></script>
    <script src='collision.js'></script>
    <script src='animation.js'></script>

    <script src='graphics.js'></script>
    <script src='map.js'></script>
  </head>

  <body>
    <canvas id='game'></canvas>

    <script>
    /* COLLIDERS */
    const coll_1x1 = new RectCollider(0,0,1,1);
    const coll_1x2 = new RectCollider(0,0,1,2);
    /**/

    /* ANIMATIONS */
    const ani_goomba_walk = new Animation([0,1],[10,10]);
    /**/

    /**/
    const sprites = {};
    const maps = {};
    let current_map;
    /**/
    </script>

    <script>
    $(document).ready( () => {
      const GC = new HTML_Canvas('game', 640, 480, '2d');
      Drawable.ctx = GC.ctx;
      Drawable.UNIT_WIDTH = Map.UNIT_WIDTH = TILE_W;
      Drawable.UNIT_HEIGHT = Map.UNIT_HEIGHT = TILE_H;


      Load_Sprites(SPRITES, sprites, () => {
        Init_Maps(MAPS, maps, () => {
          current_map = maps['World 1-1'];

          setInterval( () => {
            GC.ctx.fillStyle = '#abc';
            GC.ctx.fillRect(0,0,640,480);
            current_map.render();
            current_map.player.draw.sheet(0);
          }, FPS);
        });
      });

    });
    </script>
  </body>
</html>
